machine:
  environment:
    MATPLOTLIBRC: tests

dependencies:
  override:
    # Needed for testing (NumPy distutils needed for install)
    - pip install --upgrade pip tox tox-pyenv numpy nox-automation
    # latest as of May 22, 2017: 2.7.13, 3.5.3, 3.6.1
    - pyenv local 2.7.12 3.5.3 3.6.1

test:
  override:
    - nox -s "unit_tests(python_version='3.5')"
    - nox -s "unit_tests(python_version='3.6')"
    - nox -s cover
    - nox -s docs
    - NO_IMAGES=True nox -s doctest
    - tox -e lint
    - nox -s functional
  post:
    - .nox/cover/bin/pip install coveralls
    - .nox/cover/bin/coveralls

general:
  branches:
    ignore:
      - gh-pages

deployment:
  release:
    tag: /.*/
    owner: dhermes
    commands:
      - python setup.py sdist bdist_wheel
      - pip install --upgrade twine
      - twine upload dist/*
